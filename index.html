<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>NMix — Home</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    :root{--brand:#e50914;--bg:#000;--text:#fff;--muted:#bbb}
    *{box-sizing:border-box}
    body{margin:0;font-family:Arial,Helvetica,sans-serif;background:var(--bg);color:var(--text)}
    header{display:flex;align-items:center;justify-content:space-between;padding:14px 18px;background:#0d0d0d;position:sticky;top:0;z-index:5}
    header img{height:38px}
    nav a{color:#fff;text-decoration:none;margin:0 10px;font-size:15px}
    .banner{position:relative;aspect-ratio:16/9;overflow:hidden}
    .banner img{width:100%;height:100%;object-fit:cover;filter:brightness(.85)}
    .banner .overlay{position:absolute;inset:0;background:linear-gradient(to top,rgba(0,0,0,.9),rgba(0,0,0,.2));display:flex;flex-direction:column;justify-content:flex-end;padding:18px}
    .banner h1{margin:0;font-size:24px}
    .banner button{margin-top:10px;padding:10px 18px;border:none;border-radius:6px;background:var(--brand);color:#fff;font-weight:700;cursor:pointer}
    section{padding:18px 14px}
    h2{font-size:20px;margin-bottom:10px}
    .grid{display:grid;grid-template-columns:repeat(3,1fr);gap:10px}
    .card{background:#111;border-radius:8px;overflow:hidden;cursor:pointer;transition:.3s}
    .card:hover{transform:scale(1.03)}
    .card img{width:100%;aspect-ratio:2/3;object-fit:cover;background:#0b0b0b}
    .card .cap{padding:8px;font-size:13px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
    footer{padding:20px;text-align:center;color:var(--muted);font-size:13px;border-top:1px solid rgba(255,255,255,.1)}
    @media(min-width:800px){.grid{grid-template-columns:repeat(6,1fr)}}
  </style>
</head>
<body>
  <header>
    <img src="assets/logo.png" alt="NMix Logo">
    <nav>
      <a href="index.html">Home</a>
      <a href="movie.html">Movies</a>
      <a href="series.html">Series</a>
    </nav>
  </header>

  <!-- Banner -->
  <div class="banner" id="mainBanner">
    <img id="bannerImg" alt="Banner">
    <div class="overlay">
      <h1 id="bannerTitle">Loading...</h1>
      <button id="bannerPlay">Play</button>
    </div>
  </div>

  <!-- Latest -->
  <section>
    <h2>Latest Releases</h2>
    <div class="grid" id="latestGrid"></div>
  </section>

  <!-- Trending -->
  <section>
    <h2>Trending Now</h2>
    <div class="grid" id="trendingGrid"></div>
  </section>

  <!-- Top 10 -->
  <section>
    <h2>Top 10</h2>
    <div class="grid" id="topGrid"></div>
  </section>

  <footer>© 2025 NMix Entertainment</footer>

  <!-- Firebase & Logic -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
    import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-database.js";

    const firebaseConfig = {
      apiKey: "AIzaSyC4S_DbJCwOyg2akeBmInBYcuBrPvvVrj8",
      authDomain: "ankmods0.firebaseapp.com",
      databaseURL: "https://ankmods0-default-rtdb.firebaseio.com",
      projectId: "ankmods0",
      storageBucket: "ankmods0.firebasestorage.app",
      messagingSenderId: "760044029682",
      appId: "1:760044029682:web:a5c234e03542c309ce726b",
      measurementId: "G-HRTZJS4YVW"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    const latestGrid = document.getElementById('latestGrid');
    const trendingGrid = document.getElementById('trendingGrid');
    const topGrid = document.getElementById('topGrid');
    const bannerImg = document.getElementById('bannerImg');
    const bannerTitle = document.getElementById('bannerTitle');
    const bannerPlay = document.getElementById('bannerPlay');
    let bannerData = null;

    const makeCard = (id, m, type='movie') => {
      const div = document.createElement('a');
      div.className = 'card';
      div.href = `details.html?type=${type}&id=${id}`;
      div.innerHTML = `
        <img src="${m.poster || m.banner || ''}">
        <div class="cap">${m.title || 'Untitled'}</div>
      `;
      return div;
    };

    function loadMovies(section, container){
      onValue(ref(db, 'movies'), snap=>{
        container.innerHTML = '';
        const data = snap.val() || {};
        Object.entries(data).forEach(([id,m])=>{
          if(m.section === section) container.appendChild(makeCard(id,m,'movie'));
        });
      });
    }

    // Banner (Random featured)
    onValue(ref(db,'movies'), snap=>{
      const data = Object.entries(snap.val()||{});
      if(data.length===0) return;
      const [id,m] = data[Math.floor(Math.random()*data.length)];
      bannerData = {id,m};
      bannerImg.src = m.banner || m.poster || '';
      bannerTitle.textContent = m.title || 'Untitled';
    });
    bannerPlay.onclick = ()=>{ if(bannerData) location.href=`details.html?type=movie&id=${bannerData.id}`; };

    // Load all sections
    loadMovies('Latest', latestGrid);
    loadMovies('Trending', trendingGrid);
    loadMovies('Top10', topGrid);
  </script>
</body>
</html>