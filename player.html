<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>NMix — Player</title>
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,viewport-fit=cover,user-scalable=no" />
<style>
:root{--brand:#e50914;--glass:rgba(20,20,20,.55);--stroke:#3a3a3a;}
*{box-sizing:border-box;margin:0;padding:0;}
html,body{height:100%;width:100%;background:#000;overflow:hidden;}
body{font-family:Arial,Helvetica,sans-serif;color:#fff;touch-action:none;}
.wrap{position:fixed;inset:0;background:#000;}
video{position:absolute;inset:0;width:100%;height:100%;object-fit:cover;transition:transform .3s;}
.fit video{object-fit:contain;}
.dim{position:absolute;inset:0;background:rgba(0,0,0,0);pointer-events:none;transition:background .2s;z-index:2;}

.topBar{
position:absolute;top:env(safe-area-inset-top,10px);left:12px;right:12px;
display:flex;justify-content:space-between;align-items:center;
z-index:6;opacity:1;transition:opacity .3s ease;
}
.btnIcon{
width:44px;height:44px;border-radius:12px;background:rgba(20,20,20,.55);
border:1px solid var(--stroke);display:flex;align-items:center;justify-content:center;
backdrop-filter:blur(6px);cursor:pointer;
}
.titleTop{
flex:1;text-align:center;margin:0 12px;padding:8px 14px;border-radius:12px;
background:rgba(20,20,20,.55);border:1px solid var(--stroke);
font-weight:700;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;
box-shadow:0 4px 14px rgba(0,0,0,.3);
}

.center{
position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);
display:flex;align-items:center;justify-content:center;gap:80px;z-index:5;
transition:opacity .3s ease;opacity:1;
}
.round{
width:70px;height:70px;border-radius:50%;
border:2px solid rgba(255,255,255,.35);
background:rgba(0,0,0,.35);
display:flex;align-items:center;justify-content:center;
cursor:pointer;transition:transform .2s;
}
.round:active{transform:scale(.95);}
.pp svg{width:56px;height:56px;}

.progress{
position:absolute;left:12px;right:12px;bottom:64px;height:4px;
background:#4b4b4b;border-radius:4px;overflow:hidden;z-index:5;
}
.progress>span{display:block;height:100%;width:0;background:var(--brand);transition:width .2s linear;}

.bottom{
position:absolute;left:0;right:0;bottom:8px;
padding:6px 14px 10px;z-index:5;
display:grid;grid-template-columns:42px 130px 1fr 42px;align-items:center;gap:14px;
transition:opacity .3s ease;opacity:1;
}
.time{font-size:14px;}
.scrub{width:100%;height:6px;background:#6b6b6b;border-radius:6px;appearance:none;outline:none;}
.scrub::-webkit-slider-thumb{appearance:none;width:0;height:0;}
.icon{width:26px;height:26px;fill:#fff;}

.hide .topBar,.hide .center,.hide .progress,.hide .bottom{opacity:0;pointer-events:none;}
.locked .topBar,.locked .center,.locked .progress,.locked .bottom{opacity:0;pointer-events:none;}

.unlock{
position:absolute;left:50%;bottom:calc(env(safe-area-inset-bottom,8px) + 40px);
transform:translateX(-50%);
background:rgba(20,20,20,.7);border:1px solid var(--stroke);
border-radius:50%;padding:14px;display:none;opacity:0;transition:opacity .4s ease;
z-index:7;cursor:pointer;
}
.unlock.show{display:block;opacity:1;}
.unlock svg{width:28px;height:28px;}

/* EDGE CONTROLS */
.edge{position:absolute;top:0;bottom:0;width:35%;z-index:4;}
.edge.left{left:0;}.edge.right{right:0;}
.edgePanel{
position:absolute;top:50%;transform:translateY(-50%);
width:64px;padding:10px 8px;border-radius:16px;
background:rgba(20,20,20,.75);border:1px solid #333;
backdrop-filter:blur(10px);
display:flex;flex-direction:column;align-items:center;justify-content:center;
opacity:0;transition:opacity .3s ease;
}
.edge.show .edgePanel{opacity:1;}
.edgeLabel{font-size:13px;color:#ccc;margin-bottom:8px;text-align:center;}
.vSlider{
writing-mode:bt-lr;-webkit-appearance:slider-vertical;
width:18px;height:180px;accent-color:#fff;background:#222;
border:none;border-radius:10px;outline:none;
}
.edge.left .edgePanel{left:20px;}
.edge.right .edgePanel{right:20px;}
</style>

</head>
<body>
<div class="wrap" id="wrap">
  <video id="vid" playsinline preload="metadata"></video>
  <div class="dim" id="dim"></div>

  <div class="topBar">
    <button class="btnIcon" id="btnClose">
      <svg class="icon" viewBox="0 0 24 24"><path d="M6 6l12 12M18 6L6 18" stroke="#fff" stroke-width="2" fill="none" stroke-linecap="round"/></svg>
    </button>
    <div class="titleTop" id="titleTop">Loading…</div>
    <button class="btnIcon" id="lockBtn">
      <svg class="icon" id="lockIcon" viewBox="0 0 24 24"><path d="M7 11V8a5 5 0 0 1 10 0v3M6 11h12v9H6z" stroke="#fff" stroke-width="2" fill="none" stroke-linecap="round"/></svg>
    </button>
  </div>

  <div class="center">
    <button class="round" id="back10"><svg class="icon" viewBox="0 0 24 24"><path d="M12 6V3L7 7l5 4V8a6 6 0 1 1-6 6" stroke="#fff" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"/></svg></button>
    <button class="round pp" id="pp"><svg viewBox="0 0 24 24"><path d="M7 5h3v14H7zM14 5h3v14h-3z" fill="#fff"/></svg></button>
    <button class="round" id="fwd10"><svg class="icon" viewBox="0 0 24 24"><path d="M12 6V3l5 4-5 4V8a6 6 0 1 0 6 6" stroke="#fff" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"/></svg></button>
  </div>

  <div class="progress"><span id="prog"></span></div>

  <div class="bottom">
    <button class="btnIcon" id="volBtn"><svg class="icon" viewBox="0 0 24 24"><path d="M4 10v4h4l5 4V6l-5 4H4z" fill="#fff"/></svg></button>
    <div class="time" id="timetxt">00:00 / 00:00</div>
    <input type="range" id="scrub" class="scrub" min="0" value="0">
    <button class="btnIcon" id="fsBtn"><svg class="icon" viewBox="0 0 24 24"><path d="M4 9V4h5M20 9V4h-5M4 15v5h5M20 15v5h-5" stroke="#fff" stroke-width="2" fill="none" stroke-linecap="round"/></svg></button>
  </div>

  <div class="unlock" id="unlock"><svg viewBox="0 0 24 24"><path d="M7 11V8a5 5 0 0 1 10 0v3M6 11h12v9H6z" stroke="#fff" stroke-width="2" fill="none" stroke-linecap="round"/></svg></div>

  <!-- Brightness / Volume -->
  <div class="edge left" id="edgeLeft">
    <div class="edgePanel">
      <div class="edgeLabel">Brightness</div>
      <input id="bright" type="range" min="0" max="100" value="100" class="vSlider">
    </div>
  </div>
  <div class="edge right" id="edgeRight">
    <div class="edgePanel">
      <div class="edgeLabel">Volume</div>
      <input id="volume" type="range" min="0" max="100" value="80" class="vSlider">
    </div>
  </div>
</div>

<script>
const qs=new URLSearchParams(location.search);
const SRC=qs.get('src')||"https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/Sintel.mp4";
const TITLE=qs.get('title')||"Untitled";
const PREV=qs.get('prev')||"";
const vid=document.getElementById('vid'),wrap=document.getElementById('wrap');
const prog=document.getElementById('prog'),scrub=document.getElementById('scrub');
const timetxt=document.getElementById('timetxt'),pp=document.getElementById('pp');
const lockBtn=document.getElementById('lockBtn'),unlockBtn=document.getElementById('unlock');
const lockIcon=document.getElementById('lockIcon'),volBtn=document.getElementById('volBtn');
const bright=document.getElementById('bright'),volume=document.getElementById('volume');
const dim=document.getElementById('dim'),edgeLeft=document.getElementById('edgeLeft'),edgeRight=document.getElementById('edgeRight');

document.getElementById('titleTop').textContent=TITLE;
vid.src=SRC;vid.playsInline=true;

function fmt(s){const m=Math.floor(s/60),ss=Math.floor(s%60);return`${String(m).padStart(2,'0')}:${String(ss).padStart(2,'0')}`;}
vid.addEventListener('timeupdate',()=>{const d=vid.duration||0,c=vid.currentTime||0;timetxt.textContent=`${fmt(c)} / ${fmt(d)}`;scrub.max=d;scrub.value=c;prog.style.width=`${(c/d)*100}%`;});
scrub.oninput=()=>vid.currentTime=Number(scrub.value);

function setPPIcon(p){pp.innerHTML=p?'<svg viewBox="0 0 24 24"><path d="M8 5l10 7-10 7V5z" fill="#fff"/></svg>':'<svg viewBox="0 0 24 24"><path d="M7 5h3v14H7zM14 5h3v14h-3z" fill="#fff"/></svg>';}
function toggle(){if(vid.paused){vid.play();setPPIcon(false);}else{vid.pause();setPPIcon(true);}showUI();}
pp.onclick=toggle;vid.onclick=toggle;
document.getElementById('back10').onclick=()=>vid.currentTime=Math.max(0,vid.currentTime-10);
document.getElementById('fwd10').onclick=()=>vid.currentTime=Math.min(vid.duration,vid.currentTime+10);

let hTimer;function showUI(){if(locked)return;wrap.classList.remove('hide');clearTimeout(hTimer);hTimer=setTimeout(()=>wrap.classList.add('hide'),2500);}
['mousemove','touchstart'].forEach(e=>wrap.addEventListener(e,showUI));

let locked=false;
lockBtn.onclick=()=>{locked=!locked;
if(locked){wrap.classList.add('locked');lockIcon.innerHTML='<path d="M6 11h12v9H6zM12 4a4 4 0 0 1 4 4v3H8V8a4 4 0 0 1 4-4z" stroke="#fff" stroke-width="2" fill="none" stroke-linecap="round"/>';unlockBtn.classList.add('show');}
else{wrap.classList.remove('locked');lockIcon.innerHTML='<path d="M7 11V8a5 5 0 0 1 10 0v3M6 11h12v9H6z" stroke="#fff" stroke-width="2" fill="none" stroke-linecap="round"/>';unlockBtn.classList.remove('show');showUI();}
};
unlockBtn.onclick=()=>{locked=false;wrap.classList.remove('locked');unlockBtn.classList.remove('show');lockIcon.innerHTML='<path d="M7 11V8a5 5 0 0 1 10 0v3M6 11h12v9H6z" stroke="#fff" stroke-width="2" fill="none" stroke-linecap="round"/>';showUI();};

function applyBrightness(v){const dark=(1-(v/100))*0.6;dim.style.background=`rgba(0,0,0,${dark})`;}
bright.oninput=e=>applyBrightness(e.target.value);
volume.oninput=e=>vid.volume=e.target.value/100;

function showEdge(s){clearTimeout(eTimer);(s==='l'?edgeLeft:edgeRight).classList.add('show');eTimer=setTimeout(()=>{edgeLeft.classList.remove('show');edgeRight.classList.remove('show');},1000);}
let eTimer=null,gSide=null,startY=0,startVal=0;
wrap.addEventListener('touchstart',e=>{const x=e.touches[0].clientX,w=innerWidth;gSide=x<w*.35?'l':(x>w*.65?'r':null);startY=e.touches[0].clientY;startVal=gSide==='l'?+bright.value:+volume.value;if(gSide)showEdge(gSide);});
wrap.addEventListener('touchmove',e=>{if(!gSide)return;const y=e.touches[0].clientY;const d=(startY-y)/3;let v=Math.max(0,Math.min(100,startVal+d));if(gSide==='l'){bright.value=v;applyBrightness(v);}else{volume.value=v;vid.volume=v/100;}showEdge(gSide);e.preventDefault();});
wrap.addEventListener('touchend',()=>gSide=null);

document.getElementById('btnClose').onclick=()=>{if(PREV)location.href=decodeURIComponent(PREV);else history.back();};
document.getElementById('fsBtn').onclick=()=>{if(!document.fullscreenElement)wrap.requestFullscreen();else document.exitFullscreen();};
vid.addEventListener('loadedmetadata',()=>{vid.volume=volume.value/100;vid.play().catch(()=>setPPIcon(true));});
</script>
</body>
</html>